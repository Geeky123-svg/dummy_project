{% extends "user.html" %}

{% block content %}
<div class="container">
    <h2>Search for Quizzes, Chapters, or Subjects</h2>

    <form method="GET" action="{{ url_for('user_bp.user_search') }}" class="mb-4">
        <input type="text" name="q" class="form-control" placeholder="Search..." value="{{ query }}">
        <button type="submit" class="btn btn-dark mt-2">Search</button>
    </form>

    {% if query %}
        <h3>Results for "{{ query }}"</h3>

        {% if results.subjects %}
            <h4>Subjects</h4>
            <ul class="list-group">
                {% for subject in results.subjects %}
                    <li class="list-group-item">{{ subject.name }}</li>
                {% endfor %}
            </ul>
        {% endif %}

        {% if results.chapters %}
            <h4 class="mt-3">Chapters</h4>
            <ul class="list-group">
                {% for chapter in results.chapters %}
                    <li class="list-group-item">{{ chapter.name }} ({{ chapter.subject.name }})</li>
                {% endfor %}
            </ul>
        {% endif %}

        {% if results.quizzes %}
            <h4 class="mt-3">Quizzes</h4>
            <ul class="list-group">
                {% for quiz in results.quizzes %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ quiz.title }} ({{ quiz.chapter.name }})</span>
                        <a href="{{ url_for('user_bp.attempt_quiz', quiz_id=quiz.id) }}" class="btn btn-dark">Start Quiz</a>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        {% if not results.subjects and not results.chapters and not results.quizzes %}
            <p class="text-muted">No results found.</p>
        {% endif %}
    {% endif %}
</div>
{% endblock %}
